SELECT TO_CHAR(CHECK_IN, 'YYYY') AS CHART_YEAR,
       TO_NUMBER(TO_CHAR(CHECK_IN, 'MM')) AS CHART_MONTH_NUM,
       TO_CHAR(CHECK_IN, 'Month', 'NLS_DATE_LANGUAGE = American') AS MONTH_LABEL,
       NVL(COUNT(*), 0) AS DATA_COUNT
  FROM COMPANION_VIEW
 WHERE TO_CHAR(CHECK_IN, 'YYYY') BETWEEN :P16_YEAR_FROM AND :P16_YEAR_TO
GROUP BY TO_CHAR(CHECK_IN, 'YYYY'), TO_CHAR(CHECK_IN, 'MM'), TO_CHAR(CHECK_IN, 'Month', 'NLS_DATE_LANGUAGE = American')
ORDER BY TO_CHAR(CHECK_IN, 'YYYY'), TO_NUMBER(TO_CHAR(CHECK_IN, 'MM'));
